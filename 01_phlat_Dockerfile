# Precision Immunotherapy Pipeline Dockerfile
#
# 
# Build with: sudo docker build --force-rm=true --no-cache -t aarjunrao/phlat - < 01_phlat_Dockerfile
# Run with sudo docker run -v , <IO_folder>:/home/datadir -i -t aarjunrao/phlat <parameters>
# Use ubuntu
FROM aarjunrao/bowtie

MAINTAINER Arjun Rao aarjunrao@soe.ucsc.edu

# Get pip and pysam
RUN wget -c https://bootstrap.pypa.io/get-pip.py; python get-pip.py
RUN pip install pysam ; rm get-pip.py
 
# Install PHLAT
RUN wget -c https://raw.githubusercontent.com/Nanolx/patchimage/master/tools/gdown.pl
RUN perl gdown.pl 'https://drive.google.com/uc?export=download&confirm=yAjx&id=0Bz-w5tutuZIYY3h5YlMzTjhnbGM' index4phlat.tar.gz
RUN curl -L "https://docs.google.com/uc?export=download&id=0Bz-w5tutuZIYeDU0VDRFWG9IVUE" > phlat-1.0.tar.gz
RUN tar -zxvf phlat-1.0.tar.gz && rm phlat-1.0.tar.gz; 
WORKDIR phlat-1.0
RUN mv ../index4phlat.tar.gz . ; rm -rf index4phlat ; tar -zxvf index4phlat.tar.gz; rm index4phlat.tar.gz

# get docker_scripts
WORKDIR /home
RUN  git clone https://github.com/arkal/docker_scripts.git; chmod +x docker_scripts/*.py 
ENTRYPOINT ["python", "/home/docker_scripts/run_phlat.py"]
CMD ["-h"]
 
